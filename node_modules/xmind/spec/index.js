!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.xmind=t():e.xmind=t()}(this,function(){return function(e){function t(i){if(o[i])return o[i].exports;var n=o[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var o={};return t.m=e,t.c=o,t.p="/",t(0)}({0:function(e,t,o){"use strict";mocha.setup("bdd"),o(93),o(94),o(95),o(96),o(97),mocha.run()},93:function(e,t){"use strict";var o=chai.assert,i=xmind.Workbook,n=xmind.Legend,r=xmind.CONST,s=xmind.utils,c={firstSheetId:"firstSheet",rootTopicId:"rootTopic",firstSheetName:"sheet 1",rootTopicName:"root topic"},d=new i(c),a=d.getPrimarySheet(),l=a.addLegend(),h=r.MAKERIDS[0],u="flag black",f=void 0,g={};g[r.ATTR_MARKERID]=h,g[r.ATTR_DESCRIPTION]=u,describe("Legend",function(){it("legend.addMarkerDescription(markerId, description)",function(){o.doesNotThrow(function(){l.addMarkerDescription(h,u),f=s.findChildNode(l.markerDescriptionsNode,{tagName:r.TAG_MARKER_DESCRIPTION,attributes:g})},"failed to execute legend.addMarkerDescription(markerId, description)"),o.ok(f,"legend.addMarkerDescription(markerId, description) not working: xml structure is wrong")}),it("legend.removeMarkerDescription(markerId)",function(){o.doesNotThrow(function(){l.removeMarkerDescription(h)},"failed to execute legend.removeMarkerDescription(markerId)"),o.equal(l.markerDescriptionsNode.childNodes.length,0,"legend.removeMarkerDescription(markerId) not working: xml structure is wrong")}),it("legend.getVisibility()",function(){o.equal(l.getVisibility(),n.DEFAULT_VISIBILITY,"legend.getVisibility() not working: visibility not correct")}),it("legend.setVisibility(value)",function(){var e="invisible";o.doesNotThrow(function(){l.setVisibility(e)},"failed to execute legend.setVisibility(value)"),o.equal(l.getVisibility(),e,"legend.setVisibility(value) not working: visibility not correct")}),it("legend.getPosition()",function(){o.deepEqual(l.getPosition(),n.DEFAULT_POSITION,"legend.getPosition() not working: position not correct")}),it("legend.setPosition(point)",function(){var e={x:200,y:200};o.doesNotThrow(function(){l.setPosition(e)},"failed to execute legend.setPosition(point)"),o.deepEqual(l.getPosition(),e,"legend.setPosition(point) not working: position not correct")})})},94:function(e,t){"use strict";var o=chai.assert,i=xmind.Workbook,n={firstSheetId:"firstSheet",rootTopicId:"rootTopic",firstSheetName:"sheet 1",rootTopicName:"root topic"},r=new i(n),s=r.getPrimarySheet(),c=s.rootTopic,d={id:"secondTopic",title:"second topic"};c.addChild(d);var a={id:"thirdTopic",title:"third topic"};c.addChild(a);var l=s.addRelationship({sourceId:n.rootTopicId,targetId:d.id});describe("Relationship",function(){it("relationship.getSource()",function(){o.equal(l.getSource(),n.rootTopicId,"relationship.getSource() not working: sourceId not correct")}),it("relationship.setSource(value)",function(){o.doesNotThrow(function(){l.setSource(a.id)},"failed to execute relationship.setSource(value)"),o.equal(l.getSource(),a.id,"relationship.setSource(value) not working: source not correct"),o.throws(function(){l.setSource(d.id)},"source & target should not be the same")}),it("relationship.getTarget()",function(){o.equal(l.getTarget(),d.id,"relationship.getTarget() not working: targetId not correct")}),it("relationship.setTarget(value)",function(){o.doesNotThrow(function(){l.setTarget(n.rootTopicId)},"failed to execute relationship.setTarget(value)"),o.equal(l.getTarget(),n.rootTopicId,"relationship.setTarget(value) not working: target not correct"),o.throws(function(){l.setTarget(a.id)},"source & target should not be the same")}),it("relationship.getTitle()",function(){o.equal(l.getTitle(),"","relationship.getTitle() not working: title not correct")}),it("relationship.setTitle(value)",function(){var e="strange relationship";o.doesNotThrow(function(){l.setTitle(e)},"failed to execute relationship.setTitle(value)"),o.equal(l.getTitle(),e,"relationship.setTitle(value) not working: title not correct")}),it("relationship.toPlainObject()",function(){l.setModifiedTime(1),o.deepEqual(l.toPlainObject(),{id:l.id,sheetId:s.id,sourceId:l.getSource(),targetId:l.getTarget(),modifiedTime:1,title:l.getTitle()},"relationship.setTitle(value) not working: title not correct")})})},95:function(e,t){"use strict";var o=chai.assert,i=xmind.Workbook,n={firstSheetId:"firstSheet",rootTopicId:"rootTopic",firstSheetName:"sheet 1",rootTopicName:"root topic"},r=new i(n),s=r.getPrimarySheet(),c={id:"secondTopic",title:"second topic"},d={id:"relationship",sourceId:n.rootTopicId,targetId:c.id},a={id:"secondRelationship",sourceId:n.rootTopicId,targetId:c.id},l=void 0,h=void 0,u=void 0;describe("Sheet",function(){it("sheet.rootTopic",function(){h=s.rootTopic,h.addChild(c),o.ok(h,"sheet.rootTopic is null")}),it("sheet.topics",function(){o.equal(s.topics.length,2,"sheet.topics is not correct")}),it("sheet.topicById",function(){o.equal(s.topicById[n.rootTopicId],h,"sheet.topicById is not correct")}),it("sheet.relationships",function(){l=s.addRelationship(d),o.equal(s.relationships.length,1,"sheet.relationships is not correct")}),it("sheet.relationshipById",function(){o.equal(s.relationshipById[d.id],l,"sheet.relationshipById is not correct")}),it("sheet.legend",function(){u=s.addLegend(),o.ok(u,"sheet.legend is not correct")}),it("sheet.getTitle()",function(){o.equal(s.getTitle(),n.firstSheetName,"sheet.getTitle() not working: title is not correct")}),it("sheet.setTitle(title)",function(){var e="new sheet";o.doesNotThrow(function(){s.setTitle(e)},"failed to execute sheet.setTitle(title)"),o.equal(s.getTitle(),e,"sheet.setTitle(title) not working: title is not correct")}),it("sheet.getModifiedTime()",function(){o.doesNotThrow(function(){new Date(s.getModifiedTime())},"failed to execute sheet.getModifiedTime()")}),it("sheet.getTheme()",function(){o.equal(s.getTheme(),"","sheet.getTheme() not working: theme is not correct")}),it("sheet.setTheme(theme)",function(){var e="theme",t=s.getModifiedTime();o.doesNotThrow(function(){s.setTheme(e)},"failed to execute sheet.setTheme(theme)"),o.equal(s.getTheme(),e,"sheet.setTheme(theme) not working: theme is not correct"),o.notEqual(s.getModifiedTime(),t,"sheet.setTheme() not working: did not change modified time")}),it("sheet.getRootTopic()",function(){o.equal(s.getRootTopic(),h,"sheet.getRootTopic() not working: rootTopic is not correct")}),describe("sheet.addRelationship(options)",function(){it("adding normally",function(){o.doesNotThrow(function(){s.addRelationship(a)},"failed to execute sheet.addRelationship(options)"),o.equal(s.relationships.length,2,"sheet.addRelationship(options) not working: relationship not added")}),it("adding with the same parameters",function(){o.throws(function(){s.addRelationship(d)},"the same relationship already exists")})}),describe("sheet.setModifiedTime()",function(){var e=1;it("set by timestamp(number)",function(){o.doesNotThrow(function(){s.setModifiedTime(e)},"failed to execute sheet.setModifiedTime(timestamp)"),o.equal(s.getModifiedTime(),e,"sheet.setModifiedTime(timestamp) not working: timestamp is not correct")}),it("set by instance of Date",function(){o.doesNotThrow(function(){s.setModifiedTime(new Date(e))},"failed to execute sheet.setModifiedTime(date)"),o.equal(s.getModifiedTime(),e,"sheet.setModifiedTime(timestamp) not working: timestamp is not correct")})}),describe("sheet.removeRelationship(relationship/*index, id, instance or sourceId, targetId*/)",function(){function e(e){o.equal(r.doc.childNodes.length,1,"workbook.removeSheet("+e+") not working: xml structure did not changed"),o.equal(r.sheets.length,1,"workbook.removeSheet("+e+") not working: workbook.sheets did not changed"),o.ok(!r.sheetById[a.id],"workbook.removeSheet("+e+") not working: workbook.sheetById did not changed")}it("sheet.relationshipsNode is a shortcut",function(){}),it("remove by id",function(){o.doesNotThrow(function(){s.removeRelationship(a.id)},"failed to execute workbook.removeSheet(id)"),e()}),it("remove by index",function(){s.addRelationship(a),o.doesNotThrow(function(){s.removeRelationship(1)},"failed to execute workbook.removeSheet(id)"),e()}),it("remove by instance",function(){var t=s.addRelationship(a);o.doesNotThrow(function(){s.removeRelationship(t)},"failed to execute workbook.removeSheet(instance)"),e()}),it("remove by sourceId & targetId",function(){s.addRelationship(a),o.doesNotThrow(function(){s.removeRelationship(a.sourceId,a.targetId)},"failed to execute workbook.removeSheet(sourceId, targetId)"),e()})}),it("sheet.destroy()",function(){})})},96:function(e,t){"use strict";var o=chai.assert,i=xmind.Workbook,n=xmind.Topic,r=xmind.CONST,s=xmind.utils,c={firstSheetId:"firstSheet",rootTopicId:"rootTopic",firstSheetName:"sheet 1",rootTopicName:"root topic"},d=new i(c),a=d.getPrimarySheet(),l=a.getRootTopic();describe("Topic",function(){it("Topic.getTopic(topic/*id or instance*/, sheet)",function(){o.equal(n.getTopic(c.rootTopicId,a),l,"Topic.getTopic(id, sheet) not working: topic is not correct"),o.equal(n.getTopic(l,a),l,"Topic.getTopic(topic, sheet) not working: topic is not correct")}),it("topic.getTitle()",function(){o.equal(l.getTitle(),c.rootTopicName,"topic.getTitle() not working: title is not correct")}),it("topic.setTitle(title)",function(){var e="new topic";o.doesNotThrow(function(){l.setTitle(e)},"failed to execute topic.setTitle(title)"),o.equal(l.getTitle(),e,"topic.setTitle(title) not working: title is not correct")}),it("topic.getModifiedTime()",function(){o.doesNotThrow(function(){new Date(l.getModifiedTime())},"failed to execute topic.getModifiedTime()")}),it("topic.getBranch()",function(){o.equal(l.getBranch(),"","topic.getBranch() not working: branch is not correct")}),it("topic.setBranch(value)",function(){var e="something";o.doesNotThrow(function(){l.setBranch(e)},"failed to execute sheet.setBranch(value)"),o.equal(l.getBranch(),e,"topic.setBranch(value) not working: branch is not correct")}),it("topic.setBranchFolded()",function(){o.doesNotThrow(function(){l.setBranchFolded()},"failed to execute sheet.setBranchFolded()"),o.equal(l.getBranch(),r.VAL_FOLDED,"topic.setBranchFolded() not working: branch is not correct")}),it("topic.getNotes()",function(){o.equal(l.getNotes(),"","topic.getNotes() not working: notes is not correct")}),it("topic.setNotes(notes)",function(){var e="some notes",t="some notes\nother notes";o.doesNotThrow(function(){l.setNotes(e)},"failed to execute sheet.setNotes(notes)"),o.equal(l.getNotes(),e,"topic.setNotes(notes) not working: notes is not correct"),o.equal(l.setNotes(t).getNotes(),t,"topic.setNotes(notes) not working: notes is not correct")}),it("topic.getLabels()",function(){o.equal(JSON.stringify(l.getLabels()),JSON.stringify([]),"topic.getLabels() not working: labels is not correct")}),it("topic.getHyperlink()",function(){o.equal(l.getHyperlink(),"","topic.getHyperlink() not working: link is not correct")}),it("topic.setHyperlink(hyperlink)",function(){var e="http://sample.com";o.equal(l.setHyperlink(e).getHyperlink(),e,"topic.setHyperlink(hyperlink) not working: link is not correct")}),it("topic.removeHyperlink()",function(){o.equal(l.removeHyperlink().getHyperlink(),"","topic.removeHyperlink() not working: link is not correct")}),it("topic.getMarkers()",function(){o.equal(JSON.stringify(l.getMarkers()),JSON.stringify([]),"topic.getMarkers() not working: markders is not correct")}),it("topic.setMarkers(markers)",function(){var e=["a","bc","d"];o.doesNotThrow(function(){l.setMarkers(e)},"failed to execute sheet.setMarkers(markers)"),o.equal(JSON.stringify(l.getMarkers()),JSON.stringify(["a","bc","d"]),"topic.setMarkers(markers) not working: markers is not correct")}),it("topic.addMarker(id)",function(){l.setMarkers([]),o.equal(JSON.stringify(l.addMarker("face").getMarkers()),JSON.stringify(["face"]),"topic.addMarker(markerId) not working: markers is not correct")}),it("topic.removeMarker(id)",function(){l.setMarkers([]),o.equal(JSON.stringify(l.addMarker("face").removeMarker("face").getMarkers()),JSON.stringify([]),"topic.addMarker(markerId) not working: markers is not correct")});var e={id:"secondTopic",title:"second topic"},t={id:"thirdTopic",title:"third topic"},i={id:"forthTopic",title:"forth topic"},d=l.addChild(e),h=l.addChild(t),u=l.addChild(i);describe("topic.isAncestorOf(targetTopic)",function(){it("check by id",function(){o.equal(d.isAncestorOf(l.id),!1,"topic.isAncestorOf(targetTopic) not working: result is wrong"),o.equal(l.isAncestorOf(d.id),!0,"topic.isAncestorOf(targetTopic) not working: result is wrong")}),it("check by instance",function(){o.equal(d.isAncestorOf(l),!1,"topic.isAncestorOf(targetTopic) not working: result is wrong"),o.equal(l.isAncestorOf(d),!0,"topic.isAncestorOf(targetTopic) not working: result is wrong")})}),describe("topic.moveTo(targetTopic)",function(){it("move by id",function(){o.doesNotThrow(function(){h.moveTo(d.id)},"failed to execute topic.moveTo(targetTopicId)")}),it("move by instance",function(){o.doesNotThrow(function(){u.moveTo(h)},"failed to execute topic.moveTo(targetTopic)")}),it("moving to null",function(){o.throws(function(){u.moveTo()},"target topic does not exist")}),it("moving to itself",function(){o.throws(function(){u.moveTo(u)},"cannot move to itself")}),it("moving to child",function(){o.throws(function(){d.moveTo(u)},"cannot move to a child topic")}),it("moving to ancestor",function(){function e(e,t){var i=s.findOrCreateChildNode(e.doc,{tagName:r.TAG_CHILDREN}),n=s.findOrCreateChildNode(i,{tagName:r.TAG_TOPICS});o.ok(!!s.findChildNode(n,{tagName:r.TAG_TOPIC,attributes:{id:t.id}}),"topic.moveTo(targetTopic) not working: xml structure is not correctly changed")}o.doesNotThrow(function(){u.moveTo(d)},"failed to execute topic.moveTo(targetTopic)"),o.equal(u.children.length,0,"topic.moveTo(targetTopic) not working: count of children is wrong"),o.equal(h.children.length,0,"topic.moveTo(targetTopic) not working: count of children is wrong"),o.equal(d.children.length,2,"topic.moveTo(targetTopic) not working: count of children is wrong"),o.equal(l.children.length,1,"topic.moveTo(targetTopic) not working: count of children is wrong"),e(l,d),e(d,h),e(d,u)})}),describe("topic.setLabels(labels)",function(){var e="a, bc , d",t=["hello","world "];it("set with string",function(){o.doesNotThrow(function(){l.setLabels(e)},"failed to execute sheet.setLabels(labels)"),o.equal(JSON.stringify(l.getLabels()),JSON.stringify(["a","bc","d"]),"topic.setLabels(labels) not working: labels is not correct"),o.equal(JSON.stringify(l.setLabels(t).getLabels()),JSON.stringify(["hello","world"]),"topic.setLabels(labels) not working: labels is not correct")}),it("set with array",function(){})}),describe("topic.addChild(/*instance or options*/)",function(){it("add with an instance",function(){}),it("add with options",function(){})}),describe("topic.removeChild(child/*id or instance*/, dryrun)",function(){it("remove by id",function(){}),it("remove by instance",function(){}),it("remove in dryrun mode",function(){})}),describe("topic.setModifiedTime()",function(){var e=1;it("set by timestamp(number)",function(){o.doesNotThrow(function(){l.setModifiedTime(e)},"failed to execute topic.setModifiedTime(timestamp)"),o.equal(l.getModifiedTime(),e,"topic.setModifiedTime(timestamp) not working: timestamp is not correct")}),it("set by instance of Date",function(){o.doesNotThrow(function(){l.setModifiedTime(new Date(e))},"failed to execute topic.setModifiedTime(date)"),o.equal(l.getModifiedTime(),e,"topic.setModifiedTime(timestamp) not working: timestamp is not correct")})})})},97:function(e,t){"use strict";var o=chai.assert,i=xmind.Workbook;describe("Workbook",function(){var e={firstSheetId:"firstSheet",rootTopicId:"rootTopic",firstSheetName:"sheet 1",rootTopicName:"root topic"},t=void 0,n=void 0,r=void 0;it("new Workbook(options)",function(){o.doesNotThrow(function(){t=new i(e),n=t.getPrimarySheet(),r=n.rootTopic},"failed to create a Workbook instance")}),it("workbook.sheetById",function(){o.equal(t.sheetById[e.firstSheetId],n,"workbook.sheetById is not working")}),it("workbook.sheets",function(){o.equal(t.sheets[0],n,"workbook.sheets is not working")}),it("workbook.getModifiedTime()",function(){o.doesNotThrow(function(){new Date(t.getModifiedTime())},"failed to execute workbook.getModifiedTime()")}),it("workbook.getPrimarySheet()",function(){o.equal(e.firstSheetName,n.getTitle(),"sheet name unmatched"),o.equal(e.rootTopicName,r.getTitle(),"root topic name unmatched")});var s={id:"secondSheet",title:"sheet 2",rootTopicId:"rootTopic",rootTopicName:"root topic"};it("workbook.addSheet(options)",function(){o.throws(function(){t.addSheet({id:e.firstSheetId,title:"",rootTopicId:"some id",rootTopicName:"some name"})},"sheet id '"+e.firstSheetId+"' already exists!"),o.doesNotThrow(function(){t.addSheet(s)},"failed to execute workbook.addSheet(options)")}),it("workbook.moveSheet(fromIndex, toIndex)",function(){o.doesNotThrow(function(){t.moveSheet(1,0)},"failed to execute workbook.moveSheet(fromIndex, toIndex)"),o.equal(t.doc.firstChild.getAttribute("id"),t.sheets[0].doc.getAttribute("id"),"workbook.moveSheet(fromIndex, toIndex) not working: xml structure did not changed"),o.notEqual(t.getPrimarySheet(),n,"workbook.moveSheet(fromIndex, toIndex) not working")}),it("workbook.destroy()",function(){t.destroy(),o.ok(t,"workbook should not be destroyed")}),it("workbook.toJSON()",function(){o.doesNotThrow(function(){t.toJSON()})}),describe("workbook.setModifiedTime()",function(){var e=1;it("set by timestamp(number)",function(){o.doesNotThrow(function(){t.setModifiedTime(e)},"failed to execute workbook.setModifiedTime(timestamp)"),o.equal(t.getModifiedTime(),e,"workbook.setModifiedTime(timestamp) not working: timestamp is not correct")}),it("set by instance of Date",function(){o.doesNotThrow(function(){t.setModifiedTime(new Date(e))},"failed to execute workbook.setModifiedTime(date)"),o.equal(t.getModifiedTime(),e,"workbook.setModifiedTime(timestamp) not working: timestamp is not correct")})}),describe("workbook.removeSheet(/* id or index or Sheet instance */)",function(){it("remove by id",function(){o.doesNotThrow(function(){t.removeSheet(s.id)},"failed to execute workbook.removeSheet(id)"),o.equal(t.doc.childNodes.length,1,"workbook.removeSheet(id) not working: xml structure did not changed"),o.equal(t.sheets.length,1,"workbook.removeSheet(id) not working: workbook.sheets did not changed"),o.ok(!t.sheetById[s.id],"workbook.removeSheet(id) not working: workbook.sheetById did not changed")}),it("remove by index",function(){t.addSheet(s),o.doesNotThrow(function(){t.removeSheet(1)},"failed to execute workbook.removeSheet(index)"),o.equal(t.doc.childNodes.length,1,"workbook.removeSheet(index) not working: xml structure did not changed"),o.equal(t.sheets.length,1,"workbook.removeSheet(index) not working: workbook.sheets did not changed"),o.ok(!t.sheetById[s.id],"workbook.removeSheet(index) not working: workbook.sheetById did not changed")}),it("remove by instance",function(){var e=t.addSheet(s);o.doesNotThrow(function(){t.removeSheet(e)},"failed to execute workbook.removeSheet(index)"),o.equal(t.doc.childNodes.length,1,"workbook.removeSheet(index) not working: xml structure did not changed"),o.equal(t.sheets.length,1,"workbook.removeSheet(index) not working: workbook.sheets did not changed"),o.ok(!t.sheetById[s.id],"workbook.removeSheet(index) not working: workbook.sheetById did not changed")}),it("Workbook.load(data) & workbook.save(filename)",function(e){var o=new XMLHttpRequest;o.open("GET","./fixtures/simple.xmind",!0),o.responseType="arraybuffer",o.onload=function(){if(200===this.status){var o=new Uint8Array(this.response);t=i.load(o),console.log(t),t.save("test.xmind"),e()}},o.send()})})})}})});